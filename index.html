<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Sinya Loyalty Dashboard (Fixed)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.5;margin:24px;color:#111}
    h1{font-size:22px;margin:0 0 16px}
    h2{font-size:18px;margin:24px 0 12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    label{display:flex;flex-direction:column;font-size:12px;color:#444}
    input,select,button{padding:8px;border:1px solid #ccc;border-radius:8px;font-size:14px}
    button{cursor:pointer;background:#0ea5e9;color:#fff;border:none}
    button.secondary{background:#64748b}
    button.danger{background:#ef4444}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{border:1px solid #ddd;padding:8px;font-size:14px;text-align:right}
    th:first-child, td:first-child{text-align:center;width:60px}
    th:nth-child(2), td:nth-child(2){text-align:right}
    th{background:#f8fafc;color:#334155}
    .table-wrap{overflow:auto;border:1px solid #e5e7eb;border-radius:8px;padding:8px;background:#fff}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap}
    .outbox{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .card{border:1px solid #e5e7eb;border-radius:10px;padding:12px;background:#fff}
    .value{font-weight:700;font-size:18px;margin-top:6px}
    .muted{color:#64748b}
    .note{font-size:12px;color:#6b7280}
  </style>
</head>
<body>
  <h1>Sinya Loyalty Dashboard（Fixed 版）</h1>
  <h2>一、基本參數</h2>
  <div class="grid">
    <label>毛利率 %（GM）
      <input id="gm" type="number" placeholder="例如 20" />
    </label>
    <label>現金占比 %
      <input id="pcash" type="number" placeholder="例如 50" />
    </label>
    <label>刷卡占比 %
      <input id="pcard" type="number" placeholder="例如 50" />
    </label>
    <label>刷卡費率 %
      <input id="cardfee" type="number" placeholder="例如 1.8" />
    </label>
    <label>其他固定行銷費（年）
      <input id="other_mkt" type="number" placeholder="例如 300000" />
    </label>
    <label class="muted">uplift 使用「複利相乘」
      <input id="use_multiplicative" type="checkbox" checked />
    </label>
  </div>

  <h2>二、運費（可選）</h2>
  <div class="grid">
    <label>運送件數
      <input id="ship_count" type="number" placeholder="0" />
    </label>
    <label>每件金額
      <input id="ship_unit" type="number" placeholder="0" />
    </label>
  </div>

  <h2>三、會員等級與購買回饋</h2>
  <div class="toolbar">
    <button id="btn_add_level">＋新增等級</button>
  </div>
  <div class="table-wrap">
    <table id="tbl_levels">
      <thead>
        <tr>
          <th>等級</th>
          <th>人數</th>
          <th>年均消費 ASP</th>
          <th>現金回饋%</th>
          <th>刷卡回饋%</th>
          <th>刪除</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <div class="grid" style="margin-top:8px">
    <label>會員人數（總，連動等級）
      <input id="members_total_auto" type="number" disabled placeholder="自動計算" />
    </label>
  </div>

  <h2>四、活動設定（uplift）</h2>
  <div class="toolbar">
    <button id="btn_add_campaign">＋新增活動</button>
  </div>
  <div class="table-wrap">
    <table id="tbl_campaigns">
      <thead>
        <tr>
          <th>#</th>
          <th>uplift %</th>
          <th>影響支付</th>
          <th>活動成本</th>
          <th>刪除</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <h2>五、操作</h2>
  <div class="toolbar">
    <button id="btn_calc">立即計算</button>
    <button id="btn_reset" class="secondary">重置</button>
  </div>

  <h2>六、年度匯總</h2>
  <div class="outbox">
    <div class="card"><div class="muted">年 Sales（uplift 後合計）</div><div id="out_sales" class="value">-</div></div>
    <div class="card"><div class="muted">年 GP</div><div id="out_gp" class="value">-</div></div>
    <div class="card"><div class="muted">回饋（購買＋其他）</div><div id="out_rebates" class="value">-</div></div>
    <div class="card"><div class="muted">刷卡費</div><div id="out_cardfee" class="value">-</div></div>
    <div class="card"><div class="muted">活動成本（合計）</div><div id="out_campcost" class="value">-</div></div>
    <div class="card"><div class="muted">其他固定行銷費</div><div id="out_other" class="value">-</div></div>
    <div class="card"><div class="muted">運費</div><div id="out_ship" class="value">-</div></div>
    <div class="card"><div class="muted">淨效益（Net）</div><div id="out_net" class="value">-</div></div>
  </div>

  <p class="note">提示：按「＋新增等級」與「＋新增活動」建立資料，再按「立即計算」。</p>

  <script src="app.js"></script>
</body>
</html>
