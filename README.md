# Sinya Loyalty v7.66 完整版（含運費 / 逐月 / 活動 / 等級回饋）

**可直接上傳 GitHub Pages** 的前端單頁版，包含：
- 核心參數（GM%、現金/刷卡占比、刷卡費率）
- 年度目標與固定費（Sales 目標、GP 目標、其他固定行銷費）
- 會員等級購買回饋（多列、加權現金/刷卡回饋率計算）
- 其他回饋（生日、UGC、推薦）
- 活動歸因（逐月 uplift%、影響支付＝全部/現金/刷卡、成本合計）
- 逐月 KPI（係數%→目標 Sales、實際 Sales、uplift 後 Sales、實際 GP）
- 運費（件數 × 每件金額，列入 Net）
- 總結輸出＋達成率＋恒等式自檢

## 公式（已校正）
- **GP = 年度 uplift 後 Sales 合計 × GM%**
- **刷卡費 = ∑( 各月「刷卡相關的 Sales」 ) × 費率**  
  其中「刷卡相關的 Sales」= 該月實際 Sales ×（1 + uplift(all) + uplift(card)）× 刷卡占比。  
  若 uplift 只影響「現金」，則不增加刷卡費基礎。
- **回饋合計 = 購買回饋（依等級×ASP×加權回饋率）＋生日＋UGC（×12）＋推薦**
- **Net = GP − 回饋 − 刷卡費 − 活動成本 − 其他固定行銷費 − 運費**
- **恒等式**（自檢）：`GP ?= Net + 回饋 + 刷卡費 + 活動 + 其他行銷 + 運費`

## 使用
1. 上傳此專案到 GitHub Repo 根目錄（例如 `sinya-loyalty-v7_66_full_v1`）。
2. 在 **Settings → Pages** 開啟 GitHub Pages 指向 `main` 分支 `/`。
3. 打開 `index.html` 即可使用。

## 小技巧
- 係數模板提供「均衡」、「Q4偏重」兩種快速填入，會自動正規化。
- 所有「％」都以**整數輸入**，程式會自動 `/100` 轉小數運算。
- 若看到 Console 提示「恒等式不平衡」，表示某處公式或輸入未納入/重複，便於除錯。
